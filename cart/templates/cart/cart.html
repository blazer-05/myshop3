{% extends 'shop/base.html' %}
{% load staticfiles %}
{% load thumbnail %}

{% block content %}
		<!-- START PAGE-CONTENT -->
		<section class="page-content">
			<div class="container">
	            <div class="row">
					<div class="col-md-12">
						<ul class="page-menu">
							<li><a href="/">Home</a></li>
							<li class="active"><a href="#">Shopping Cart</a></li>
						</ul>
					</div>
				</div>
				<div class="row">
					<div class="col-md-3">
						{% include 'shop/menu-category.html' %} <!-- Подгружаем код из шаблона shop/menu-category.html -->
						{% include 'shop/bestseller.html' %} <!--Подгружаем код из файла shop/bestseller.html -->
					</div>
					<div class="col-md-9">
						<!-- START PRODUCT-BANNER -->
						<div class="product-banner">
							<div class="row">
								<div class="col-xs-12">
									<div class="banner">
										<a href="#"><img src="{% static 'shop/img/banner/12.jpg' %}" alt="Product Banner"></a>
									</div>
								</div>
							</div>
						</div>
						<!-- END PRODUCT-BANNER -->
						<!-- Start Shopping-Cart -->
						<div class="shopping-cart">
							<div class="row">
								<div class="col-md-12">
									<div class="cart-title">
										<h2 class="entry-title">Shopping Cart</h2>
									</div>
									<!-- Start Table -->
                                    {% if cart.items.count > 0 %}
									<div class="table-responsive">
										<table class="table table-bordered bmw">
											<thead>
												<tr>
													<td class="text-center">Image</td>
													<td class="text-left">Product Name</td>
{#													<td class="text-left">Quantity</td>#}
													<td class="text-left">Quantity</td>
													<td class="text-right">Total</td>
													<td class="text-right">Unit Price</td>
												</tr>
											</thead>
                                            {% for item in cart.items.all %}
											<tbody>
												<tr class="cart-item-{{ item.product.id }}">
													<td class="text-center">
														<a href="{{ item.product.get_absolute_url }}">
                                                            <img class="img-thumbnail" src="{{ item.product.images|thumbnail_url:'cart' }}" alt="{{ item.product.title }}" />
                                                        </a>
													</td>
													<td class="text-left">
														<a href="{{ item.product.get_absolute_url }}">{{ item.product.title }}</a>
													</td>
{#													<td class="text-center">{{ item.qty }}</td>#}
													<td class="text-left">
														<div class="btn-block cart-put">
                                                            <form action="" method="GET">
															<input class="form-control cart-item-qty" data-id="{{ item.id }}" type="number" name="qty" value="{{ item.qty }}" min="1"/>
                                                            </form>
															<div class="input-group-btn cart-buttons">
{#																<button class="btn btn-primary" data-toggle="tooltip" title="Update">#}
{#																	<i class="fa fa-refresh"></i>#}
{#																</button>#}
                                                                <a href="" class="remove_from_cart" data-slug="{{ item.product.slug }}" data-id="{{ item.product.id }}">
                                                                    <button class="btn btn-danger" data-toggle="tooltip" title="Remove">
                                                                        <i class="fa fa-times-circle"></i>
                                                                    </button>
                                                                </a>
															</div>
														</div>
													</td>
                                                    <td class="text-right" id="cart-item-total-{{ item.id }}">&#8381; {{ item.item_total }}</td>
                                                    <td class="text-right" id="cart-item-total-{{ item.id }}">&#8381; {{ item.product.price }}</td>
{#													<td class="text-right" id="cart-total-price">$</td>#}
												</tr>
											</tbody>
                                            {% endfor %}
										</table>
									</div>
                                    <h3 class='cart-empty'></h3>
                                        <br>
                                    {% else %}
                                        <h3 class="text-left"><strong>Your basket is empty</strong></h3>
                                        <br>
                                    {% endif %}
                                <!-- Скрипт автоматического удаления товара из корзины без перезагрузки страницы. Для 73стр. -->
                                <script src="{% static 'shop/js/jquery-1.11.3.min.js' %}"></script>
                                    <script>
                                    $(document).ready(function(){
                                        $('.cart-empty').css('display', 'none')
                                        $('.remove_from_cart').on('click', function(e){
                                            e.preventDefault()
                                            product_slug = $(this).attr('data-slug')
                                            item_product_id = $(this).attr('data-id')
                                            data = {
                                                product_slug: product_slug
                                            }
                                            $.ajax({
                                                type: "GET",
                                                url: '{% url "cart:remove_from_cart" %}',
                                                data: data,
                                                success: function(data){
                                                    $("#cart_count").html(data.cart_total) // В base.html 199 стр.
                                                    $('.cart-item-'+item_product_id).css('display', 'none')
                                                    $('.cart-total-price').html('<strong>&#8381; ' + parseFloat(data.cart_total_price).toFixed(2) + '</strong>' ) // В base.html 200 стр.
                                                    if(parseInt(data.cart_total) == 0){
                                                        $('.table-responsive').css('display', 'none')
                                                        $('.cart-empty').css('display', 'block')
                                                        $('.cart-empty').html('<h3 class="text-left"><strong>Your basket is empty</strong></h3>')
                                                    }
                                                }
                                            })
                                        })
                                    })
                                    // Скрипт автоматического увеличения товара в корзине
                                        $(document).ready(function(){
                                            $('.cart-item-qty').on('click', function(){
                                                qty = $(this).val()
                                                item_id = $(this).attr('data-id')
                                                data = {
                                                    qty: qty,
                                                    item_id: item_id
                                                }
                                                $.ajax({
                                                    type: "GET",
                                                    url: '{% url "cart:change_item_qty" %}',
                                                    data: data,
                                                    success: function(data){
                                                        $('#cart-item-total-'+item_id).html('&#8381; ' + parseFloat(data.item_total).toFixed(2) )  //В cart.html 83 и 84 стр. добавляет товар в корзине на 1 с пересчетом суммы.
                                                        $('.cart-total-price').html('<strong>&#8381; ' + parseFloat(data.cart_total_price).toFixed(2) + '</strong>' ) // В base.html 200 стр. Общая сумма товара в корзине
                                                    }
                                                })
                                            })
                                        })
                                    </script>
									<!-- End Table -->
									<h3 class="title-group-3 gfont-1">What would you like to do next?</h3>
									<p>Choose if you have a discount code or reward points you want to use or would like to estimate your delivery cost.</p>
									<!-- Accordion start -->
									<div class="accordion-cart">
										<div class="panel-group" id="accordion">
											<!-- Start Coupon -->
											<div class="panel panel_default">
												<div class="panel-heading">
													<h4 class="panel-title">
														<a class="accordion-trigger" data-toggle="collapse" data-parent="#accordion" href="#coupon">Use Coupon Code<i class="fa fa-caret-down"></i> </a>
													</h4>
												</div>
												<div id="coupon" class="collapse in">
													<div class="panel-body">
														<div class="col-sm-2">
															<p>Enter your coupon here</p>
														</div>
														<div class="input-group">
															<input class="form-control" type="text" placeholder="Enter your coupon here" />
															<button type="submit" class="btn btn-primary">Apply Coupon</button>
														</div>
													</div>
												</div>
											</div>
											<!-- End Coupon -->
											<!-- Start Voucher -->
											<div class="panel panel_default">
												<div class="panel-heading">
													<h4 class="panel-title">
														<a class="accordion-trigger collapsed" data-toggle="collapse" data-parent="#accordion" href="#voucher">Use Gift Voucher <i class="fa fa-caret-down"></i> </a>
													</h4>
												</div>
												<div id="voucher" class="collapse">
													<div class="panel-body">
														<div class="col-sm-2">
															<p>Enter your gift voucher code here</p>
														</div>
														<div class="input-group">
															<input class="form-control" type="text" placeholder="Enter your gift voucher code here" />
															<button type="submit" class="btn btn-primary">Apply Voucher</button>
														</div>
													</div>
												</div>
											</div>
											<!-- Start Voucher -->
											<!-- Start Shipping -->
											<div class="panel panel_default">
												<div class="panel-heading">
													<h4 class="panel-title">
														<a class="accordion-trigger collapsed" data-toggle="collapse" data-parent="#accordion" href="#shipping">Estimate Shipping & Taxes <i class="fa fa-caret-down"></i> </a>
													</h4>
												</div>
												<div id="shipping" class="collapse">
													<div class="panel-body">
														<div class="col-sm-12">
															<p>Enter your destination to get a shipping estimate.</p>
														</div>
														<div class="form-horizontal">
															<div class="form-group">
																<label class="col-sm-2 control-label"><sup>*</sup>Country</label>
																<div class="col-sm-10">
																	<select class="form-control">
																		<option> --- Please Select --- </option>
																		<option> Bangladesh </option>
																		<option> United States </option>
																		<option> United Kingdom </option>
																		<option> Canada </option>
																		<option> Malaysia </option>
																		<option> United Arab Emirates </option>
																	</select>
																</div>
															</div>
															<div class="form-group">
																<label class="col-sm-2 control-label"><sup>*</sup>Region / State</label>
																<div class="col-sm-10">
																	<select class="form-control">
																		<option> --- Please Select --- </option>
																		<option> Aberdeen </option>
																		<option> Bedfordshire </option>
																		<option> Caerphilly </option>
																		<option> Denbighshire </option>
																		<option> East Ayrshire </option>
																		<option> Falkirk </option>
																	</select>
																</div>
															</div>
															<div class="form-group">
																<label class="col-sm-2 control-label"><sup>*</sup>Post Code</label>
																<div class="col-sm-10">
																	<input type="text" class="form-control" placeholder="Post Code" />
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
											<!-- Start Shipping -->
										</div>
									</div>
									<!-- Accordion end -->
									<div class="row">
										<div class="col-sm-4 col-sm-offset-8">
											<table class="table table-bordered">
												<tbody>
{#													<tr>#}
{#														<td class="text-right">#}
{#															<strong>Sub-Total:</strong>#}
{#														</td>#}
{#														<td class="text-right">$</td>#}
{#													</tr>#}
													<tr>
														<td class="text-right">
															<strong>Total:</strong>
														</td>
                                                        <td class="text-right cart-total-price"><strong>&#8381; {{ cart.cart_total }} </strong></td>
													</tr>
												</tbody>
											</table>
										</div>
									</div>
									<div class="shopping-checkout">
										<a href="#" class="btn btn-default pull-left">Continue Shopping</a>
										<a href="#" class="btn btn-primary pull-right">Checkout</a>
									</div>
								</div>
							</div>
						</div>
						<!-- End Shopping-Cart -->
					</div>
				</div>
			</div>
        </section>
{% endblock content %}

{% comment %}

		<!-- START PAGE-CONTENT -->
		<section class="page-content">
			<div class="container">
	            <div class="row">
					<div class="col-md-12">
						<ul class="page-menu">
							<li><a href="/">Home</a></li>
							<li class="active"><a href="#">Shopping Cart</a></li>
						</ul>
					</div>
				</div>
				<div class="row">
					<div class="col-md-3">
						{% include 'shop/menu-category.html' %} <!-- Подгружаем код из шаблона shop/menu-category.html -->
						{% include 'shop/bestseller.html' %} <!--Подгружаем код из файла shop/bestseller.html -->
					</div>
					<div class="col-md-9">
						<!-- START PRODUCT-BANNER -->
						<div class="product-banner">
							<div class="row">
								<div class="col-xs-12">
									<div class="banner">
										<a href="#"><img src="{% static 'shop/img/banner/12.jpg' %}" alt="Product Banner"></a>
									</div>
								</div>
							</div>
						</div>
						<!-- END PRODUCT-BANNER -->
						<!-- Start Shopping-Cart -->
						<div class="shopping-cart">
							<div class="row">
								<div class="col-md-12">
									<div class="cart-title">
										<h2 class="entry-title">Shopping Cart</h2>
									</div>
									<!-- Start Table -->
									<div class="table-responsive">
										<table class="table table-bordered">
											<thead>
												<tr>
													<td class="text-center">Image</td>
													<td class="text-left">Product Name</td>
													<td class="text-left">Model</td>
													<td class="text-left">Quantity</td>
													<td class="text-right">Unit Price</td>
													<td class="text-right">Total</td>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td class="text-center">
														<a href="#"><img class="img-thumbnail" src="{% static 'shop/img/product/cart/1.jpg' %}" alt="#" /></a>
													</td>
													<td class="text-left">
														<a href="#">More-Or-Less</a>
													</td>
													<td class="text-left">Product 14</td>
													<td class="text-left">
														<div class="btn-block cart-put">
															<input class="form-control" type="number" placeholder="1" />
															<div class="input-group-btn cart-buttons">
																<button class="btn btn-primary" data-toggle="tooltip" title="Update">
																	<i class="fa fa-refresh"></i>
																</button>
																<button class="btn btn-danger" data-toggle="tooltip" title="Remove">
																	<i class="fa fa-times-circle"></i>
																</button>
															</div>
														</div>
													</td>
													<td class="text-right">$100.00</td>
													<td class="text-right">$100.00</td>
												</tr>
												<tr>
													<td class="text-center">
														<a href="#"><img class="img-thumbnail" src="{% static 'shop/img/product/cart/2.jpg' %}" alt="#" /></a>
													</td>
													<td class="text-left">
														<a href="#">More-Or-Less</a>
													</td>
													<td class="text-left">Product 14</td>
													<td class="text-left">
														<div class="btn-block cart-put">
															<input class="form-control" type="number" placeholder="1" />
															<div class="input-group-btn cart-buttons">
																<button class="btn btn-primary" data-toggle="tooltip" title="Update" >
																	<i class="fa fa-refresh"></i>
																</button>
																<button class="btn btn-danger" data-toggle="tooltip" title="Remove">
																	<i class="fa fa-times-circle"></i>
																</button>
															</div>
														</div>
													</td>
													<td class="text-right">$100.00</td>
													<td class="text-right">$100.00</td>
												</tr>
											</tbody>
										</table>
									</div>
									<!-- End Table -->
									<h3 class="title-group-3 gfont-1">What would you like to do next?</h3>
									<p>Choose if you have a discount code or reward points you want to use or would like to estimate your delivery cost.</p>
									<!-- Accordion start -->
									<div class="accordion-cart">
										<div class="panel-group" id="accordion">
											<!-- Start Coupon -->
											<div class="panel panel_default">
												<div class="panel-heading">
													<h4 class="panel-title">
														<a class="accordion-trigger" data-toggle="collapse" data-parent="#accordion" href="#coupon">Use Coupon Code<i class="fa fa-caret-down"></i> </a>
													</h4>
												</div>
												<div id="coupon" class="collapse in">
													<div class="panel-body">
														<div class="col-sm-2">
															<p>Enter your coupon here</p>
														</div>
														<div class="input-group">
															<input class="form-control" type="text" placeholder="Enter your coupon here" />
															<button type="submit" class="btn btn-primary">Apply Coupon</button>
														</div>
													</div>
												</div>
											</div>
											<!-- End Coupon -->
											<!-- Start Voucher -->
											<div class="panel panel_default">
												<div class="panel-heading">
													<h4 class="panel-title">
														<a class="accordion-trigger collapsed" data-toggle="collapse" data-parent="#accordion" href="#voucher">Use Gift Voucher <i class="fa fa-caret-down"></i> </a>
													</h4>
												</div>
												<div id="voucher" class="collapse">
													<div class="panel-body">
														<div class="col-sm-2">
															<p>Enter your gift voucher code here</p>
														</div>
														<div class="input-group">
															<input class="form-control" type="text" placeholder="Enter your gift voucher code here" />
															<button type="submit" class="btn btn-primary">Apply Voucher</button>
														</div>
													</div>
												</div>
											</div>
											<!-- Start Voucher -->
											<!-- Start Shipping -->
											<div class="panel panel_default">
												<div class="panel-heading">
													<h4 class="panel-title">
														<a class="accordion-trigger collapsed" data-toggle="collapse" data-parent="#accordion" href="#shipping">Estimate Shipping & Taxes <i class="fa fa-caret-down"></i> </a>
													</h4>
												</div>
												<div id="shipping" class="collapse">
													<div class="panel-body">
														<div class="col-sm-12">
															<p>Enter your destination to get a shipping estimate.</p>
														</div>
														<div class="form-horizontal">
															<div class="form-group">
																<label class="col-sm-2 control-label"><sup>*</sup>Country</label>
																<div class="col-sm-10">
																	<select class="form-control">
																		<option> --- Please Select --- </option>
																		<option> Bangladesh </option>
																		<option> United States </option>
																		<option> United Kingdom </option>
																		<option> Canada </option>
																		<option> Malaysia </option>
																		<option> United Arab Emirates </option>
																	</select>
																</div>
															</div>
															<div class="form-group">
																<label class="col-sm-2 control-label"><sup>*</sup>Region / State</label>
																<div class="col-sm-10">
																	<select class="form-control">
																		<option> --- Please Select --- </option>
																		<option> Aberdeen </option>
																		<option> Bedfordshire </option>
																		<option> Caerphilly </option>
																		<option> Denbighshire </option>
																		<option> East Ayrshire </option>
																		<option> Falkirk </option>
																	</select>
																</div>
															</div>
															<div class="form-group">
																<label class="col-sm-2 control-label"><sup>*</sup>Post Code</label>
																<div class="col-sm-10">
																	<input type="text" class="form-control" placeholder="Post Code" />
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
											<!-- Start Shipping -->
										</div>
									</div>
									<!-- Accordion end -->
									<div class="row">
										<div class="col-sm-4 col-sm-offset-8">
											<table class="table table-bordered">
												<tbody>
													<tr>
														<td class="text-right">
															<strong>Sub-Total:</strong>
														</td>
														<td class="text-right">$145.00</td>
													</tr>
													<tr>
														<td class="text-right">
															<strong>Total:</strong>
														</td>
														<td class="text-right">$145.00</td>
													</tr>
												</tbody>
											</table>
										</div>
									</div>
									<div class="shopping-checkout">
										<a href="#" class="btn btn-default pull-left">Continue Shopping</a>
										<a href="#" class="btn btn-primary pull-right">Checkout</a>
									</div>
								</div>
							</div>
						</div>
						<!-- End Shopping-Cart -->
					</div>
				</div>
			</div>
        </section>

{% endcomment %}